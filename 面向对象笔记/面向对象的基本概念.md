# 面向对象的基本概念

面向对象三特征：封装，继承，多态。

## 「面向过程」，「面向对象」？

众所周知，C语言是个面向过程的程序设计语言；Python，Java，C++都是（或者至少可以是）面向对象的程序设计语言。那什么是面向对象，什么是面向过程？

## 面向过程的设计思想

### 面向过程的设计想法

面向过程设计强调**对功能的分解**，然后**逐个实现**。

人话：先找到过程中的**动作**，思考每个动作**是否要做成一个函数。**

设计步骤：

1. 确定系统需要的操作（动作/函数）

2. 根据需要的操作，思考需要的数据，设计适合的数据存储结构

   > 每个算法都可能需要对数据存储结构做操作。表现在每个函数的参数都有个接受一个数据存储结构的参数
   >
   > 比如往下看，有个函数的定义例子，这个定义的第一个参数就是数据结构（ Accout 类型）的。

面向过程认为：**程序 = 数据结构 + 算法**。

因此，面向过程思想分裂了数据和方法两部分。

### 面向过程存在的问题

1. 可重用性差

   数据类型和算法都不能重用。

   比如，我为了银行创建了一个 Account 数据结构，用来表示一个存款账户；一个取款方法：

   ```c
   int withdraw(Account account, float money)
   ```

   但是，银行不只有存款账户一种账户；说不定还有保险账户，理财账户……这些账户可能也可以取钱。但现在的 withdraw 方法完全不能接受其他类型的账户，只能整个重写一个方法，创建一个新的数据类型。

   这就是**「可重用性差」。**

2. 可维护性差

   比如，像上边的例子，添加一种银行账户需要重写所有的方法（ withdraw 之类的），非常滴累。

### 面向过程问题的原因

面向过程分析问题时，着眼于需要解决哪些问题，有哪些功能，根据功能设计数据结构。但**功能可能随需求的变化而变化，而功能一旦变化，数据结构也需要变化**。

面向过程看似分裂了数据和方法，实则每个方法都与数据结构高度耦合；修改数据结构，方法要跟着改；修改功能（方法），数据结构要跟着改，说不定还会因为数据结构的更改连累其他方法一起被更改。

所以，面向过程是一种“一修改就累死人”的程序设计方法。

### 面向过程适合哪种程序？

面向过程适合小程序，或者单个算法的系统。此外，还适合于基本没有变化的较大型系统。不适合频繁变化的大型系统。

## 面向对象设计思想

面向对象设计的核心是**确定所需的对象**。

对象，一般是一些数据和数据关联的方法组成的一个东西。

面向对象的设计步骤：

1. 确定接受消息的对象

   在编程语言中：确定哪些东西需要作为对象来创建一个类。

   举个上边有了的例子：

   银行账户本身可以作为一个对象 - `class Account`

2. 确定每个对象上可以执行的操作。这些操作就是外界能够对该对象做的事情。

   这些操作，一般来说，是**必须要改变对象的数据**的操作。

   举个例子：

   - 存款：`Account.Deposit`
   - 取款：`Account.withdraw`

### 面向对象的好处

- 稳定

  只需要修改部分对象的数据或者方法即可实现需求的更改。

- 可重用性更好

  在添加新的对象时，可以基于已有的对象（继承）添加一个新的对象，然后针对该新对象编写数据和方法即可，不需要修改（或只需要很少的修改）已有的对象。

- 面向对象的描述方式和现实世界更加贴合

## 对象

对象是**应用领域**中一个有意义的事物。它可以代表现实中确实存在的一个事物，也可以代表一种概念。

### 对象的性质

1. 标识：每个对象必须要有一个独一无二的名字

   程序语言中一般用「标识符」（或者变量名）来完成这个工作。

2. 状态：对象需要一些属性（也可以说是数据）来存储它携带的信息

   “状态”是对象拥有的所有属性的总和。

   程序语言中使用「变量」完成此工作。

   变量可以有一个或者多个，这些变量可能会是其他的对象。

3. 行为：对象拥有一些可以执行的操作

   即：其他对象发起请求时，该对象如何反应。

   程序语言中使用「方法」（或者说「成员函数」）完成此工作。

如果两个对象的标识，状态，行为有一个不同，它们就不是同一个对象。

### 对象的交互

系统运行时，不同的对象一定需要相互交互。怎么交互呢？通过对象间的消息传递。怎么进行消息传递呢？通过**调用接受消息对象的特定方法**，**并附上适当的参数**。

完全孤立的对象是没有用处的；程序运行时对象间必定会有相互交流。

### 消息

- 同一个对象可以接受很多消息，做出不同的反应。

- 相同的消息可以发送给不同对象，且不同对象接收到该消息后行为可能不同
- 消息的发送可以不考虑接受者的感受（这个可以叫做广播消息）；接受消息的对象也可以选择不做出响应。

## 类

类是一堆具有相同数据和相同行为的对象的集合

- 相同数据：对象的属性（数据）是否一致
- 相同行为：对象可执行的动作/操作是否一致。

类是静态的。类可以看成一个“批量生产某种对象”的一个模版，在执行前就已经完成了定义。

对象是动态的，在程序运行时可以新增或者被删除。对象一定是从类产生的，不能是自己没有父类蹦出来的（）。

在 Java 当中，程序猿不用主动删除不用的对象， Java 的 gc（自动垃圾回收） 会干掉它们。不过，在其它一些语言，比如C++中，程序员需要手动删除自己创建的对象。

### 数据的抽象

一个对象是现实中（应用领域中）一个东西的抽象。

不过，同一个对象在不同处境下，只有一部分属性是正常工作的。抽象时会强调对象与应用方法相关的操作，不使用没有关系的操作。

一个类是很多对象的抽象。抽象时，关键是要找到重要的类，以及对象操作中部分与目标有关的方法。（即：找到你需要的对象的接口（函数））

## 封装

### 对象的封装

把类实现的细节和数据隐藏起来叫作封装。

把对象内部的信息进行屏蔽，让其他人只能使用对象允许的行为对它进行操作。这些被屏蔽的东西主要是对象内部的数据，也可以是对象内部不希望公开的行为。

因为数据很重要，所以对象应当只允许使用它规定的方法对数据进行修改。比如，想想上面提到过的`Account`类，如果用户可以直接修改自己账户的余额（可能是 `Account.money` 之类的数据），那简直是灾难。因此，`Account` 对象被封装起来，只允许用户通过 `Account.Deposit` 和 `Account.withdraw` 来存款和取款。

设计者应当有这样的思想：数据能不公开就不公开。不管是用户还是其他对象，都应当通过向待修改的对象发送消息，让接受的对象自己修改自己的数据。对于用户来说，应该只有界面（Interface ，也有接口的意思）可见，实现不应当可见。

在 Java 里头，封装是通过各种修饰词，比如 `public` , `private` , `protected` 这些来实现的。 

### 封装的好处

提供保护：

- 保护对象，防止被用户误使用
- 对于其他使用者，当实现改变时，保护对象对外的接口不被改变

对象的实现可能会改变，为了：

- 修正BUG
- 重写以提高性能
- 改变自身的部分行为（函数名，函数参数等）

如果进行了良好的封装，使用者就不需要修改自己的调用方法了。

## 继承

继承是一种类和类之间的关系

### 父类和子类

继承是类实现“可重用”和“可扩充”的最主要的方法。

- 可重用：
  - 可以处理一堆相似的对象的相似的部分，避免代码的重复
  - 可以避免不一致性
  - 可以在修改时省好多时间
- 可扩充：
  - 可以修改类来处理其他的需求

父类（Super）是一个比较一般的类，子类（Son）是父类中特殊的一种情形。父类只有一个的情况叫做单继承；父类有多个的话叫做多继承。Java 只允许单继承，它通过接口实现某种程度的多继承；C++ 和 Python 支持多重继承。

子类可以继承父类的所有属性与操作。子类还可以额外定义一些属性和操作，或者修改（编程语言中一般叫重写）父类的操作。

继承是“子类是一种父类， is a ”的关系。继承可以减少重复定义函数之类的事，对于修BUG的程序员十分友好，更改函数时只要改一个就行了。
